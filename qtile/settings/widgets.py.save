from libqtile import widget
from .colors import colors

from .custom_widgets.cwlan import CustomWlan
from .custom_widgets.cworkspace import CustomWorkspace
from .custom_widgets.cvolume import CustomVolume
from .custom_widgets.cshutdown import CustomShutdown

import subprocess

# WIDGETS
widgets= [
	widget.TextBox('󰣇', fontsize=25,padding=20),
        widget.Sep(),
        *CustomWorkspace,
	widget.Spacer(),
	widget.GenPollText(
		update_interval=0,
		func=lambda: subprocess.check_output(
	        	['/home/santiago/.config/qtile/settings/scripts/get_player.sh']
    		).decode('utf-8').strip(),
    		scroll=True,
    		scroll_step=1,
    		scroll_interval=0.2,
    		mouse_callbacks={
        		'Button1': lambda: subprocess.Popen(['playerctl', 'play-pause']),
        		'Button4': lambda: subprocess.Popen(['playerctl', 'previous']),
        		'Button5': lambda: subprocess.Popen(['playerctl', 'next']),
    		},
	),
	widget.Spacer(),
	widget.Sep(),
        CustomVolume(),
	widget.Sep(),
	CustomWlan(
                interface="wlan0",
                update_interval=1,
	),
	widget.Sep(),
	widget.CPU(
		format='  {load_percent}%'
	),
	widget.Sep(),
	widget.Memory(
		format='  {MemUsed:.1f}/{MemTotal:.0f}{mm}',
    		measure_mem='G',
    		update_interval=1.0,
	),
	widget.Sep(),
	widget.Battery(
		format='{char} {percent:2.0%}',
    		full_short_text='󰂅',
		full_char="󰂅",
		charge_char='󰢝',
    		discharge_char='󰁾',
    		empty_char='󱃍',
		low_percentage=0.2,
		low_foreground="#FF0000",
		update_interval = 1,
	),
	widget.Sep(),
        widget.Clock(
		format=" %Y/%m/%d  %I:%M %p",
	),
	widget.Sep(),
	widget.KeyboardLayout(
		configured_keyboards=['us', 'latam'],
    		display_map={'us': 'EN', 'latam': 'ES'},
    		mouse_callbacks={
        		'Button1': lambda: subprocess.Popen(
				['bash', '/home/santiago/.config/qtile/settings/scripts/toogle_layout.sh']
			)
		},
	),
	widget.Sep(),
        widget.QuickExit(
           	default_text='󰐥',  
    		countdown_format='[{}]', 
    		timeout=5,
                fontsize=16
        ),
#        CustomShutdown,
	widget.Sep(),
]

widget_defaults = dict(
    font="GeistMono NF",
    fontsize=13,
)

extension_defaults = widget_defaults.copy()
